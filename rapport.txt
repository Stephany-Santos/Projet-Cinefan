Schéma relationnel
genre ( intitule, description)
Clé primaire : intitule
artiste ( id, nom, prenom, role, cree_par)
Clé primaire : id
Clé étrangère : cree_par référence à pseudo dans la table utilisateur
media ( id, titre, description, parution, type, realise, suite, genre, cree_par)
Clé primaire : id
Clé étrangère : realise référence à id dans artiste
suite référence à id dans media
genre référence à intitule dans genre
cree_par référence à pseudo dans utilisateur
participe ( id_artiste, id_media, id_perso)
Clé primaire : (id_artiste, id_media, id_perso)
Clé étrangère : id_media référence à id dans media
id_artiste référence à id dans artiste
id_perso référence à id dans personnage
utilisateur ( pseudo, nom, biographie, typeDeCompte, mail, mdp, dateDeCreation)
Clé primaire : pseudo
Clé étrangère : favori référence à id dans media
commente ( date, texte, note, utilisateur, id_media)
Clé primaire : (utilisateur, id_media, date)
Clé étrangère : utilisateur référence à pseudo dans utilisateur
id_media référence à id dans media
personnage ( id, nom, prenom, description, cree_par, media)
Clé primaire : id
Clé étrangère : cree_par référence à pseudo dans utilisateur
id référence à id dans media
image ( fichier, lien, alt, media, artiste, personnage, cree_par)
Clé primaire : fichier
Clé étrangère : media référence à id dans media
artiste référence à id dans artiste
personnage référence à id dans personnage
cree_par référence à pseudo dans utilisateur
Justifications des choix de type et contraintes
Varchar / char : Utilisé pour des chaînes de longueur limitée
Text : Permet de stocker des descriptions longues sans limites de taille (description, biographie, texte,
alt).
Serial : Gère automatiquement les identifiants (id) pour les entités principales comme artiste, media,
personnage.
Date / Default : Utilisé pour les champs temporels, avec une valeur par défaut pour la date de création
ou de commentaire (CURRENT_DATE).
Demandes supplémentaires du client
Pour chaque acteur, le nombre de films de chaque genre dans lesquels il a joué, trié par nombre de
films descendant.
CREATE VIEW filmsParActeur AS (
SELECT count(media.genre) AS nombreDeFilms, artiste.nom, artiste.prenom,
media.genre
FROM artiste
)
Le nombre de critiques écrites par chaque membre du club.
CREATE VIEW nbCritiques AS (
SELECT utilisateur.pseudo, COUNT(commente.utilisateur) AS nombreDeCritiques
FROM utilisateur
LEFT JOIN commente ON utilisateur.pseudo = commente.utilisateur
GROUP BY utilisateur.pseudo
);
Le nombre moyen de critiques écrites par utilisateur pour chaque genre.
CREATE VIEW moyenneCritiques AS (
SELECT media.genre, AVG(nbCritiques.nombreDeCritiques) AS
moyenneCritiquesParGenre );
FROM media
JOIN commente ON media.id = commente.id_media
JOIN nbCritiques ON commente.utilisateur = nbCritiques.pseudo
GROUP BY media.genre
)
